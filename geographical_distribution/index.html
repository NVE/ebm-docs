

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Geographical distribution &mdash; EBM - Energibruksmodell  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=9ed7352e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api_reference.html" />
    <link rel="prev" title="Energy use" href="../energy_use/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EBM - Energibruksmodell
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about_the_model.html">About EBM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_description.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results.html">Result files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../limitations.html">Limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Functionality</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../model_description/index.html">Model Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_parameters/index.html">Building categories and building codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../area/index.html">Area</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy_need/index.html">Energy need</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heating_systems/index.html">Heating systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy_use/index.html">Energy use</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Geographical distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-functionality">Model functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assumptions">Assumptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#detailed-description">Detailed description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EBM - Energibruksmodell</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Geographical distribution</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/geographical_distribution/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geographical-distribution">
<span id="geographical-distribution-doc"></span><h1>Geographical distribution<a class="headerlink" href="#geographical-distribution" title="Link to this heading"></a></h1>
<p>This page offers a comprehensive description of the <code class="docutils literal notranslate"><span class="pre">ebmgeodist</span></code> geographical distribution module in the EBM package.
The module provides functionality to distribute the national energy use results from EBM down to energy use per municipality,
providing a more detailed and accurate representation of energy use patterns across the country.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#model-functionality" id="id1">Model functionality</a></p></li>
<li><p><a class="reference internal" href="#assumptions" id="id2">Assumptions</a></p>
<ul>
<li><p><a class="reference internal" href="#detailed-description" id="id3">Detailed description</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#limitations" id="id4">Limitations</a></p></li>
</ul>
</nav>
<section id="model-functionality">
<h2>Model functionality<a class="headerlink" href="#model-functionality" title="Link to this heading"></a></h2>
<p>The geographical distribution method implemented in <code class="docutils literal notranslate"><span class="pre">ebmgeodist</span></code> provides a systematic way to allocate national or regional
energy use projection results to finer geographical units — in our case, municipalities.</p>
<p>Energy use models like EBM typically provide energy use forecasts at a national or regional level. However, for effective
energy planning and policy-making, results often need to be distributed to smaller geographical units.
This method achieves this by distributing annual energy use forecasts to a smaller geographical area, while ensuring that the total energy use
remains consistent with the national results.</p>
<p>The method involves the following steps:</p>
<ol class="arabic simple">
<li><p><strong>Data Collection</strong>: Gather relevant statistics on energy consumption at the desired geographical level. This may include historical energy use data,
demographic information, and other relevant factors that influence energy consumption.</p></li>
<li><p><strong>Distribution Key Calculation</strong>: Calculate distribution keys for each energy product (electricity, district heating, bioenergy, and fossil fuels) based on the collected data.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[f_{m,g} = \frac{C_{m,g}}{\Sigma_{j\in all \, municipalities}C_{j,g}}\]</div>
<p>Where <span class="math notranslate nohighlight">\(f_{m,g}\)</span> is the distribution key for municipality <em>m</em> and building category <em>g</em>, <span class="math notranslate nohighlight">\(C_{m,g}\)</span> is the total consumption for municipality <em>m</em> and building category <em>g</em>,
and the denominator is representing the total consumption for all municipalities and building category g.</p>
<p>These keys represent the share of total energy consumption attributed to each geographical unit.</p>
<ol class="arabic simple" start="3">
<li><p><strong>Energy Use Distribution</strong>: Apply the distribution keys to the annual energy use forecast results from EBM to allocate energy use to each geographical unit:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\text{Consumption}_{m,g} = f_{m,g} \: \mathsf x \: \text{National total}_{g}\]</div>
<ol class="arabic simple" start="4">
<li><p><strong>Validation</strong>: Validate the distributed results to ensure that they are consistent with consumption statistics and that the total national energy use remains unchanged.</p></li>
<li><p><strong>Output Generation</strong>: Generate output files that contain the distributed energy use data for each geographical unit, which can be used for further analysis and planning.</p></li>
</ol>
<p>The geographical distribution method is designed to be flexible and can be adapted to different geographical levels and energy products as needed.</p>
</section>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Link to this heading"></a></h2>
<p>Elhub data has been used to find representative distribution keys for each Norwegian municipality. Elhub is a central data hub for Norway’s power industry, and
the hub provides among other things, electricity consumption data per each measurement point for different regions and municipalities in Norway. Knowing the
total electricity consumption for residential, holiday home, and non-residential buildings categories in each municipality, we can find the corresponding share of electricity for that municipality
compared to the national level. This share is then used as a key to distribute the annual forecasted EBM energy use results. The geographical distribution module considers four different energy
products: electricity, district heating, bioenergy, and fossil fuels. Furthermore, three different building categories are included; residential, holiday homes and
non-residential buildings. The distribution keys for electricity are generated inside the module, either using Elhub API or using attached consumption data stored in the file 🧾 <a class="reference internal" href="../input_description.html#yearly-aggregated-elhub-data-parquet"><span class="std std-ref">yearly_aggregated_elhub_data.parquet</span></a> under <code class="docutils literal notranslate"><span class="pre">📁input</span></code>.
The Elhub API option assumes that the user has access to Elhub data via Azure Blob Storage.
As for the other energy products, the distribution keys are loaded from input files under <code class="docutils literal notranslate"><span class="pre">📁input</span></code>. The input files are provided along with the module.
The following table gives an overview of the implemented functionality introduced in the module, including the input files for each energy product:</p>
<section id="detailed-description">
<h3>Detailed description<a class="headerlink" href="#detailed-description" title="Link to this heading"></a></h3>
<p>The following is a more detailed description of how the distribution keys for each energy product are obtained:</p>
<ul>
<li><p>Electricity: the distribution keys for electricity is calculated directly from Elhub data. The total electricity consumption per each municipality is divided
by the total electricity consumption in Norway to get the share of electricity consumption for each municipality. This share is then used as a distribution key
to distribute the annual EBM energy use projection results for electricity. The user can here choose between two options:</p>
<blockquote>
<div><ul class="simple">
<li><p>Generate the distribution keys using Elhub API inside the module, this assumes that the user has access to Elhub data via Azure Blob Storage.</p></li>
<li><p>Use the precalculated distribution keys provided by the input file under the <code class="docutils literal notranslate"><span class="pre">input</span></code> folder. The file name is
<code class="docutils literal notranslate"><span class="pre">yearly_aggregated_elhub_data.parquet</span></code>. Accessing and loading the Elhub data directly from Azure Blob Storage will save the loaded data in a new
file with the same name but with an additional timestamp, under the <code class="docutils literal notranslate"><span class="pre">input</span></code> folder. The purpose of the timestamp is to distinguish between
different versions of the file. Later, the user may reuse this new file to extract distribution keys rather than regenerating them via the Elhub API.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>District heating: the distribution keys for district heating are loaded from an input file under the <code class="docutils literal notranslate"><span class="pre">input</span></code> folder. The file name
is <code class="docutils literal notranslate"><span class="pre">fjernvarme_kommune_fordelingsnøkler.xlsx</span></code>.</p></li>
<li><p>Bioenergy: the distribution keys for bioenergy are loaded from an input file under the <code class="docutils literal notranslate"><span class="pre">input</span></code> folder. The file name is
is <code class="docutils literal notranslate"><span class="pre">ved_kommune_fordelingsnøkler.xlsx</span></code>.</p></li>
<li><p>Fossil fuels: the distribution keys for fossil fuels are loaded from an input file under the <code class="docutils literal notranslate"><span class="pre">input</span></code> folder. The file name is
is <code class="docutils literal notranslate"><span class="pre">ved_kommune_fordelingsnøkler.xlsx</span></code>.</p></li>
</ul>
<p>The geographical distribution module makes the following assumptions:</p>
<ul class="simple">
<li><p>The Elhub data used to calculate the distribution keys for electricity is representative for the entire projection period. Since the available Elhub
data is from the year 2022 onwards, the module assumes that the electricity consumption patterns per municipality will remain relatively stable over time.
The implemented method calculates an average electricity consumption per municipality based on the available Elhub data, and uses this average to find
distribution keys for the entire projection period. This results in static distribution keys for electricity that does not change over time.</p></li>
<li><p>The electricity distribution keys for the moment do not take into account demographic changes, such as population growth or decline, which may affect electricity
consumption patterns in different municipalities over time. However, it is intended to implement a method that adjusts the electricity distribution keys
based on projected demographic changes in future versions of the module.</p></li>
<li><p>The distribution keys for district heating, bioenergy, and fossil fuels are assumed to be static and do not change over time. This means that the module assumes
that the consumption patterns for these energy products will remain relatively stable over the projection period.</p></li>
<li><p>For district heating, the holiday homes building category is not considered. This means that the module assumes that the
district heating consumption in holiday homes is negligible and does not significantly affect the overall distribution of district
heating consumption across municipalities.</p></li>
<li><p>For bioenergy, the commercial buildings building category is not considered. This means that the module assumes that the
bioenergy consumption in commercial buildings is negligible and does not significantly affect the overall distribution of bioenergy
consumption across municipalities.</p></li>
<li><p>For fossil fuels, the households and commercial buildings categories are not included. This is not because their consumption is assumed to be negligible, but
because the module currently lacks reliable data to calculate distribution keys for these categories.</p></li>
<li><p>For the combination of bioenergy and holiday homes, the module assumes that the distribution keys for bioenergy consumption in holiday homes
are the same as for those for electricity and holiday homes. This assumption is made due to the lack of specific data on bioenergy consumption in holiday homes.</p></li>
<li><p>For the combination of fossil fuels and holiday homes, the module assumes that the distribution keys for fossil fuel consumption in holiday homes
are the same as for those for electricity and holiday homes. This assumption is made due to the lack of specific data on fossil fuel consumption in holiday homes.</p></li>
</ul>
</section>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Link to this heading"></a></h2>
<p>The geographical distribution module has the following limitations:</p>
<ul class="simple">
<li><p>Currently, the module distributes annual EBM energy use projection results only at the municipality level. However, future versions are intended to support
additional levels of geographical distribution, such as price areas and grid zones.</p></li>
<li><p>Distribution keys for electricity can only be generated via the Elhub API for years from 2022 onwards, since Elhub data is available only
from that year.</p></li>
<li><p>The module does not currently account for demographic changes, such as population growth or decline, which may affect electricity consumption patterns.
However, it is intended to implement a method that adjusts the electricity distribution keys based on projected demographic changes in future versions
of the module.</p></li>
</ul>
<p>Last Updated on 2025-10-14</p>
<p>Version: 0.99.6.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../energy_use/index.html" class="btn btn-neutral float-left" title="Energy use" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api_reference.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, The Norwegian Water Resources and Energy Directorate (NVE).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>